<section class="o-Stack o-Stack--split@m o-Stack--medium u-Phm">
  <div class="o-Stack__item o-Stack__item--30@m u-Mbh">
    <h2 class="b-TypeHeading--secondary b-TypeHeading--divider">Manage Columns</h2>
    <ul>
    <%= for %{id: id, title: title, pos: pos} <- @board.columns do %>
      <li class="card card-manage u-Mvm" phx-click="column_edit" phx-value="<%= id %>">
        <div class="card-manage__arrows">
          <%= if pos > 0 do %>
            <a phx-click="col_up" phx-value="<%= id %>" href="#" class="card-manage__arrow">
              <%= fas("angle-up") %>
            </a>
          <% end %>
          <%= if pos < length(@board.columns) - 1 do %>
            <a phx-click="col_down" phx-value="<%= id %>" href="#" class="card-manage__arrow">
              <%= fas("angle-down") %>
            </a>
          <% end %>
        </div>
        <div class="card-manage__title">
          <%= title %>
        </div>
        <a class="u-Phm" href="#" phx-click="delete_column" phx-value="<%= id %>">
          <i class="fa fa-minus-circle" aria-hidden="true"></i>
        </a>
      </li>
    <% end %>
    </ul>
    
    <%
      cs_data = Ecto.Changeset.apply_changes(@column_changeset)
      {button_txt, title} =
        if cs_data.id,
          do: {"Update", "Editing Column: #{cs_data.title}"},
          else: {"Create", "Create Column"}
    %>

    <h3 class="b-TypeHeading--tertiary"><%= title %></h3>

    <%= form_for @column_changeset, "#", [phx_submit: :column_save], fn f -> %>
      <%= text_input f, :title, placeholder: "New column title", class: "input u-Mbm" %>
      <%= error_tag f, :title %>
      <%= submit button_txt, phx_disable_with: "Saving...", class: "button is-primary" %>
    <% end %>
  </div>

<!--
<section class="column-manager clearpls">
<h2>Manage Columns</h2>

    <h3 class="subtitle u-Mbm"><%= title %></h3>
    <%
      cs_data = Ecto.Changeset.apply_changes(@column_changeset)

      {button_txt, title} =
        if cs_data.id,
          do: {"Update", "Editing Column: #{cs_data.title}"},
          else: {"Create", "Create Column"}
    %>

    <h3><%= title %></h3>

    <%= form_for @column_changeset, "#", [phx_submit: :column_save], fn f -> %>
      <%= text_input f, :title, placeholder: "New column title", class: "input u-Mbm" %>
      <%= error_tag f, :title %>
      <%= submit button_txt, phx_disable_with: "Saving...", class: "button is-primary" %>
    <% end %>
  </div>
  -->
  <div class="o-Stack__item o-Stack__item--70s@m o-Stack--split@m">
  <div class="o-Stack__item u-Phm">
    <h2 class="b-TypeHeading--secondary b-TypeHeading--divider u-Mbs">Board Settings</h2>
    <%= form_for @board_settings_changeset, "#", [phx_submit: :board_settings_save], fn f -> %>
      <%= label(:likes_per_user, "Likes Per User") %>
      <%= text_input f, :likes_per_user, class: "input u-Mbm" %>
      <%= error_tag f, :likes_per_user %>
      <%= label(:likes_per_user, "Likes Per User per Card") %>
      <%= text_input f, :likes_per_user_per_card, class: "input u-Mbm" %>
      <%= error_tag f, :likes_per_user_per_card %>
      <br />
      <%= submit "Save", phx_disable_with: "Saving...", class: "button is-primary" %>
    <% end %>
  </div>

  <div class="o-Stack__item u-Phm">
      <h2 class="b-TypeHeading--secondary b-TypeHeading--divider u-Mbs">Manage Roles</h2>
      <form phx-change="role_suggest" phx-submit="grant" class="u-Mbl">
      Grant owner access to 
      <input class="input u-Mbm" type="text" name="user" list="matches" placeholder="Find User...">
      <datalist id="matches">
        <%= for user <- @role_users_suggest do %>
          <option value="<%= user.id %>"><%= display_name(user) %></option>
        <% end %>
      </datalist>
      <input type="submit" value="Grant" class="button is-primary">
      </form>
      <ul>
        <% more_than_one_owner = more_than_one_owner(@board.board_roles) %>
        <%= for role <- @board.board_roles do %>
          <li class="o-Stack o-Stack--center-row">
            <%= avatar(role.user) %>
            <%= display_name(role.user) %>
            (<%= role.role %>)
            <%= if more_than_one_owner do %>
            <a href="#" phx-click="revoke" phx-value="<%= role.user.id %>">
              <%= fas("user-minus") %>
            </a>
            <% end %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</section>
